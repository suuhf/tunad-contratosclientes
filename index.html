<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Tunad - Contratos de Clientes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --lima: #DED138;
            --laranja: #F8773B;
            --azul: #67BBB8;
            --roxo: #A1529A;
            --preto: #191D23;
            --branco: #ffffff;
            --cinza-claro: #f5f5f5;
            --cinza: #e0e0e0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--preto);
            padding: 20px;
        }

        .header {
            background: var(--preto);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            width: 60px;
            height: 60px;
            position: relative;
        }

        .logo-square {
            width: 18px;
            height: 18px;
            position: absolute;
        }

        .logo-lima { background: var(--lima); top: 0; left: 0; }
        .logo-laranja { background: var(--laranja); top: 0; right: 0; }
        .logo-roxo { background: var(--roxo); bottom: 0; left: 0; }
        .logo-azul { background: var(--azul); bottom: 0; right: 0; }

        .logo-text {
            font-size: 48px;
            font-weight: bold;
            color: var(--branco);
            letter-spacing: 2px;
        }

        .header-info {
            text-align: right;
            color: var(--branco);
        }

        .header-info h2 {
            font-size: 16px;
            font-weight: normal;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .header-info .date {
            font-size: 14px;
            opacity: 0.6;
        }

        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: var(--branco);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 5px solid var(--lima);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .kpi-card:nth-child(2) { border-left-color: var(--laranja); }
        .kpi-card:nth-child(3) { border-left-color: var(--azul); }
        .kpi-card:nth-child(4) { border-left-color: var(--roxo); }

        .kpi-label {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .kpi-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--preto);
            line-height: 1.2;
        }

        .kpi-subtitle {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        .filters {
            background: var(--branco);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: 600;
            color: var(--preto);
        }

        .filter-group input,
        .filter-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--cinza);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--azul);
        }

        .table-container {
            background: var(--branco);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, var(--preto) 0%, #2a2e35 100%);
            color: var(--branco);
        }

        thead th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            user-select: none;
        }

        thead th:hover {
            background: rgba(255,255,255,0.1);
        }

        tbody tr {
            border-bottom: 1px solid var(--cinza);
            transition: background 0.2s;
            cursor: pointer;
        }

        tbody tr:hover {
            background: var(--cinza-claro);
        }

        tbody td {
            padding: 15px;
            font-size: 14px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-sim {
            background: rgba(103, 187, 184, 0.2);
            color: var(--azul);
        }

        .badge-risco {
            background: rgba(248, 119, 59, 0.2);
            color: var(--laranja);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .engagement-bar {
            width: 100%;
            height: 8px;
            background: var(--cinza);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .engagement-fill {
            height: 100%;
            transition: width 0.5s ease;
        }

        .engagement-fill.low {
            background: linear-gradient(90deg, var(--laranja), #ff6b6b);
        }

        .engagement-fill.medium {
            background: linear-gradient(90deg, var(--lima), var(--laranja));
        }

        .engagement-fill.high {
            background: linear-gradient(90deg, var(--azul), var(--lima));
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .dashboard-grid.two-cols {
            grid-template-columns: 1fr 1fr;
        }

        .chart-container {
            background: var(--branco);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chart-container h3 {
            margin-bottom: 15px;
            color: var(--preto);
            font-size: 16px;
            border-bottom: 3px solid var(--lima);
            padding-bottom: 8px;
        }

        .ranking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--cinza-claro);
            border-radius: 10px;
            margin-bottom: 10px;
            transition: transform 0.2s;
        }

        .ranking-item:hover {
            transform: translateX(5px);
        }

        .ranking-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--azul);
            color: var(--branco);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .ranking-item.top-1 .ranking-number {
            background: linear-gradient(135deg, var(--lima), #f0e130);
        }

        .ranking-item.top-2 .ranking-number {
            background: linear-gradient(135deg, var(--azul), #5aa9a6);
        }

        .ranking-item.top-3 .ranking-number {
            background: linear-gradient(135deg, var(--laranja), #e66a35);
        }

        .ranking-info {
            flex: 1;
            display: flex;
            align-items: center;
        }

        .ranking-score {
            font-size: 20px;
            font-weight: bold;
            color: var(--preto);
            margin-left: auto;
        }

        .chart-bar {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .chart-bar-label {
            width: 150px;
            font-size: 13px;
            font-weight: 600;
        }

        .chart-bar-container {
            flex: 1;
            height: 30px;
            background: var(--cinza);
            border-radius: 15px;
            overflow: hidden;
        }

        .chart-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--azul), var(--roxo));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: var(--branco);
            font-size: 12px;
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--branco);
            margin: 5% auto;
            padding: 0;
            width: 90%;
            max-width: 800px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideDown 0.3s;
            max-height: 85vh;
            overflow-y: auto;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: linear-gradient(135deg, var(--preto) 0%, #2a2e35 100%);
            color: var(--branco);
            padding: 25px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 24px;
        }

        .modal-header .valor-destaque {
            font-size: 20px;
            color: var(--lima);
            font-weight: bold;
            margin-top: 5px;
        }

        .close {
            color: var(--branco);
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .close:hover {
            transform: scale(1.2);
        }

        .modal-body {
            padding: 30px;
        }

        .detail-section {
            margin-bottom: 25px;
        }

        .detail-section h3 {
            color: var(--preto);
            margin-bottom: 15px;
            font-size: 18px;
            border-left: 4px solid var(--azul);
            padding-left: 10px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .detail-item {
            background: var(--cinza-claro);
            padding: 15px;
            border-radius: 10px;
        }

        .detail-item label {
            display: block;
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .detail-item value {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: var(--preto);
        }

        .observacoes-box {
            background: #fff9e6;
            border-left: 4px solid var(--lima);
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
        }

        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .dashboard-grid.two-cols {
                grid-template-columns: 1fr;
            }
            .detail-grid {
                grid-template-columns: 1fr;
            }
            .kpi-container {
                grid-template-columns: 1fr;
            }
        }

        .dias-restantes {
            font-size: 14px;
            color: #666;
            margin-top: 2px;
        }
        
        .dias-restantes.urgente {
            color: var(--laranja);
            font-weight: bold;
        }
        
        .dias-restantes.atencao {
            color: var(--lima);
        }

        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--cinza-claro);
            border-top: 2px solid var(--cinza);
        }
        
        .pagination-info {
            font-size: 14px;
            color: #666;
        }
        
        .pagination-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .pagination-btn {
            padding: 8px 16px;
            background: var(--azul);
            color: var(--branco);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .pagination-btn:hover:not(:disabled) {
            background: var(--roxo);
            transform: translateY(-2px);
        }
        
        .pagination-btn:disabled {
            background: var(--cinza);
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .pagination-pages {
            display: flex;
            gap: 5px;
        }
        
        .pagination-page {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--branco);
            border: 2px solid var(--cinza);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .pagination-page:hover {
            border-color: var(--azul);
            color: var(--azul);
        }
        
        .pagination-page.active {
            background: var(--azul);
            color: var(--branco);
            border-color: var(--azul);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-container">
            <div class="logo">
                <div class="logo-square logo-lima"></div>
                <div class="logo-square logo-laranja"></div>
                <div class="logo-square logo-roxo"></div>
                <div class="logo-square logo-azul"></div>
            </div>
            <div class="logo-text">TUNAD</div>
        </div>
        <div class="header-info">
            <h2>Contratos de Clientes</h2>
            <div class="date" id="currentDate"></div>
        </div>
    </div>

    <div class="kpi-container">
        <div class="kpi-card">
            <div class="kpi-label">Receita Mensal Total</div>
            <div class="kpi-value" id="receitaTotal">R$ 0</div>
            <div class="kpi-subtitle">Receita recorrente mensal</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-label">Clientes Ativos</div>
            <div class="kpi-value" id="clientesAtivos">0</div>
            <div class="kpi-subtitle">Contratos em vigor</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-label">Taxa de Engajamento</div>
            <div class="kpi-value" id="taxaEngajamento">0%</div>
            <div class="kpi-subtitle">Média de abertura de reports</div>
        </div>
        <div class="kpi-card">
            <div class="kpi-label">Clientes em Risco</div>
            <div class="kpi-value" id="clientesRisco">0</div>
            <div class="kpi-subtitle">Alto potencial de churn</div>
        </div>
    </div>

    <div class="filters">
        <div class="filter-group">
            <label>Pesquisar Cliente</label>
            <input type="text" id="searchInput" placeholder="Digite o nome do cliente...">
        </div>
        <div class="filter-group">
            <label>Filtrar por Agência</label>
            <select id="agenciaFilter">
                <option value="">Todas as Agências</option>
            </select>
        </div>
        <div class="filter-group">
            <label>Tipo de Contrato</label>
            <select id="contratoFilter">
                <option value="">Todos os Tipos</option>
            </select>
        </div>
        <div class="filter-group">
            <label>Status de Risco</label>
            <select id="riscoFilter">
                <option value="">Todos</option>
                <option value="risco">Em Risco</option>
                <option value="seguro">Seguro</option>
            </select>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th onclick="sortTable(0)">Cliente</th>
                    <th onclick="sortTable(1)">Agência</th>
                    <th onclick="sortTable(2)">Contrato Até</th>
                    <th onclick="sortTable(3)">Valor/Mês</th>
                    <th onclick="sortTable(4)">Tipo</th>
                    <th>Engajamento</th>
                    <th>Serviços</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <tr><td colspan="8" style="text-align:center;padding:50px;">Carregando dados...</td></tr>
            </tbody>
        </table>
        <div class="pagination-container">
            <div class="pagination-info">
                Mostrando <span id="showingStart">0</span> a <span id="showingEnd">0</span> de <span id="totalClientes">0</span> clientes
            </div>
            <div class="pagination-buttons">
                <button class="pagination-btn" id="btnPrevious" onclick="previousPage()">← Anterior</button>
                <div class="pagination-pages" id="paginationPages"></div>
                <button class="pagination-btn" id="btnNext" onclick="nextPage()">Próxima →</button>
            </div>
        </div>
    </div>

    <div class="dashboard-grid">
        <div class="chart-container">
            <h3>Top 10 - Clientes Mais Engajados</h3>
            <div id="topEngajados"></div>
        </div>
        <div class="chart-container">
            <h3>Top 10 - Clientes Menos Engajados</h3>
            <div id="topMenosEngajados"></div>
        </div>
        <div class="chart-container">
            <h3>Top 10 - Contratos Vencendo</h3>
            <div id="topVencendo"></div>
        </div>
    </div>

    <div class="dashboard-grid two-cols">
        <div class="chart-container">
            <h3>Receita por Tipo de Contrato</h3>
            <div id="receitaTipo"></div>
        </div>
        <div class="chart-container">
            <h3>Distribuição de Serviços</h3>
            <div id="distribuicaoServicos"></div>
        </div>
    </div>

    <div id="clienteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h2 id="modalTitle">Detalhes do Cliente</h2>
                    <div class="valor-destaque" id="modalValor"></div>
                </div>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script>
    const clientesData = [{"CONTRATO ATÉ": "2026-03-01 00:00:00", "CLIENTE": "BET365", "AGÊNCIA": "Betc HAVAS", "Valor/mês": 57000, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Sim", "API": "Sim", "OBSERVAÇÕES": "20/01 TROCANDO E-MAILS ESCLARECENDO DÚVIDAS SOBRE EXTRAÇÃO DE CSV NA PLATAFORMA E CONTATO VIA WHATSAPP.", "ABERTURA DE REPORT": "2 de 13", "QUEM ABRIU": "Kevin Silva", "Valor_Limpo": 57000.0, "Abertura_Parsed": {"abertos": 2, "total": 13, "percentual": 15.384615384615385}}, {"CONTRATO ATÉ": "2026-03-01 00:00:00", "CLIENTE": "BURGER KING | ZAMP", "AGÊNCIA": "ALMAP", "Valor/mês": 40000, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Sim", "API": "Sim", "OBSERVAÇÕES": "15/01 REUNIÃO GABRIELA TUCCI CONFIGURAÇÃO E DÚVIDAS SOBRE APPSFLYER. ACOMPANHANDO, POIS TEM PREVISÃO DE CAMPANHA NO INÍCIO DE FEVEREIRO", "ABERTURA DE REPORT": "2 de 10", "QUEM ABRIU": "José Machado, Gabriela Tucci\n", "Valor_Limpo": 40000.0, "Abertura_Parsed": {"abertos": 2, "total": 10, "percentual": 20.0}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "CIELO", "AGÊNCIA": "ALMAP", "Valor/mês": "Valores não encontrados", "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Sim", "API": "Sim", "OBSERVAÇÕES": "FOLLOW DESDE O INÍCIO DO ANO, DIA 19/01 CAMILA, PESSOA NOVA DE MÍDIA QUE VAI FICAR NA LINHA DE FRENTE, MANDOU DÚVIDAS E AGENDAMOS CALL PARA DIA 22/01. ESTOU EM CIMA, POIS PRECISAM USAR PARA VIRAR O CONTRATO ANUAL. VI A OPORTUNIDADE DE CRIAR O REPORT SOMENTE DOS PATROCÍNIOS NO PROGRAMA PEQUENAS EMPRESAS GRANDES NEGOCIOS", "ABERTURA DE REPORT": "4 de 11", "QUEM ABRIU": "Regiane Silva, Willian Se, Gustavo Olivo, Lucas Turquetto", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 4, "total": 11, "percentual": 36.36363636363637}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "CLARO", "AGÊNCIA": "TALENT", "Valor/mês": "Valores não encontrados", "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Sim", "API": "Sim", "OBSERVAÇÕES": "FELIPE BORGES DA TALENT ESTÁ SEMPRE EM CONTATO, PREFERE FALAR PELO WHATSAPP, EN 19/01 PEDIU TOKEN PARA CONFIGURAR API, JÁ CONFIGUREI CAMPANHA PARA QUE ELE APRESENTE PARA A CLARO E ME PEDIU 2 ACESSOS PARA O CLIENTE FINAL DO ANO PASSADO. PRÓXIMO PASSO É ORGANIZAR OS TREINAMENTOS", "ABERTURA DE REPORT": "0 de 2", "QUEM ABRIU": "Vitor Kamada, Felipe Borges", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 0, "total": 2, "percentual": 0.0}}, {"CONTRATO ATÉ": "2026-05-01 00:00:00", "CLIENTE": "CONSÓRCIO SERVOPA", "AGÊNCIA": "SENSO PERFORMANCE", "Valor/mês": "Valores não encontrados", "Tipo de Contrato": "Sync", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "12/01 ENSINEI A CONFIGURAÇÃO DO SYNC, ELES ESTÃO EXPERIMENTANDO E PENSANDO EM ESTRATÉGIA VÃO USAR. O OBJETIVO É ACOMPANHAR O CONCORRENTE ADEMICON NO BBB26. MAS TAMBÉM VÃO PEGAR OUTRAS CAMPANHAS DE ADEMICON. NOVO FOLLOW EM 20/01. GOSTARAM TANTO QUE JÁ EMPLACARAM OUTRO CLIENTE COM A GENTE O VERO INTERNET", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-06-01 00:00:00", "CLIENTE": "ESTÁCIO", "AGÊNCIA": "ARTPLAN | CADASTRA", "Valor/mês": 13775, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Sim", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "09/01 RODANDO CAMPANHA WYDEN, PRAÇA MANAUS E ACOMPANHAMENTO DAS AÇÕES DE ESTÁCIO DENTRO DO BBB26, COM ENVIO DE REPORTS. CONTATO QUASE QUE DIÁRIO DESDE SEMANA PASSADA.", "ABERTURA DE REPORT": "3 de 9", "QUEM ABRIU": "Erica Martins, Mídia Estácio, Adelson Tuche", "Valor_Limpo": 13775.0, "Abertura_Parsed": {"abertos": 3, "total": 9, "percentual": 33.33333333333333}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "GDB (SUPERBET)", "AGÊNCIA": "ANTIGA ROIX", "Valor/mês": 1200, "Tipo de Contrato": "Sync", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "13/01 JÚLIA MANDOU PI, TIREI DÚVIDAS. TIVEMOS UM BUG NO CARREGAMENTO E SALVAMENTO DO TRIGGER, MAS EDINHO FEZ UMA SOLUÇÃO PALEATIVA E SEGUE INVESTIGANDO O QUE FOI. 20/01 TRIGGER FUNCIONANDO", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 1200.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "GDB (SADIA)", "AGÊNCIA": "ANTIGA ROIX", "Valor/mês": 1200, "Tipo de Contrato": "Sync", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "20/01 FOLLOW COM SABRINA, POIS TEM QUE ENVIAR A PI. ELA TAMBÉM ESTÁ VENDO INTERNAMENTE SOBRE A CONFIGURAÇÃO DO META", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 1200.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2026-05-01 00:00:00", "CLIENTE": "GETNET", "AGÊNCIA": "W3HAUS | CAPSULA", "Valor/mês": 10000, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Sim", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "05/01 KELLY ENVIOU OS COMPROVANTES REFERENTE ÀS CAMPANHAS DE TESTEMUNHAL DAS RÁDIOS DE DEZEMBRO, FIZEMOS E ENVIAMOS O REPORT. 16/01 ANA DE FÉRIAS, RETORNOU SEMANA PASSADA E ESTAMOS AGENDADAS DIA 22/01 PARA PASSAR FEEDBACKS SOBRE OS REPORTS ENVIADOS", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 10000.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "GOL", "AGÊNCIA": "ALMAP", "Valor/mês": NaN, "Tipo de Contrato": "Report único", "Sync": "Não", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "19/01 RICARDO FALOU COM LUCAS TURQUETTO, POIS LÁ DENTRO DA AGÊNCIA ELES NÃO SABEM DIZER COMO VAI FICAR O ANO.", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "GRUPO RIC", "AGÊNCIA": "NÃO TEM", "Valor/mês": 6500, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "15/01/2026 – MARCOS STAICHAKA ENVIOU E-MAIL CANCELANDO O CONTRATO. MAIOR PARTE DOS CLIENTES DELE SÃO DE MÉDIO E PEQUENO PORTE E NÃO ESTÃO CONSEGUINDO OBTER AS INFORMAÇÕES DEVIDO AO BAIXO VOLUME DE BUSCAS.", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 6500.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "HYUNDAI MOTOR BRASIL", "AGÊNCIA": "INNOCEAN", "Valor/mês": 15000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "06/01 PEGUEI BRIEFING COM SELVA PARA O REPORT MENSAL E EM 19/01 EM CONTATO COM DANIEL QUE ESTÁ COBRINDO AS FÉRIAS DA SELVA", "ABERTURA DE REPORT": "0 de 12", "QUEM ABRIU": "-", "Valor_Limpo": 15000.0, "Abertura_Parsed": {"abertos": 0, "total": 12, "percentual": 0.0}}, {"CONTRATO ATÉ": "Rotativo", "CLIENTE": "IMMAKERS (SADIA)", "AGÊNCIA": "IMMAKERS", "Valor/mês": 3000, "Tipo de Contrato": "Sync", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 3000.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-07-01 00:00:00", "CLIENTE": "LOCALIZA", "AGÊNCIA": "NÃO TEM", "Valor/mês": 15000, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Sim", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "2 de 9", "QUEM ABRIU": "-", "Valor_Limpo": 15000.0, "Abertura_Parsed": {"abertos": 2, "total": 9, "percentual": 22.22222222222222}}, {"CONTRATO ATÉ": "2026-05-01 00:00:00", "CLIENTE": "MERCADO LIVRE | MERCADO PAGO", "AGÊNCIA": "GUT", "Valor/mês": 45000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Sim", "API": "Sim", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "6 de 15", "QUEM ABRIU": "Nataly Goes, Mídia Meli, Daniel Amorim, Thaís Sampaio, Carolina Stival, Vitoria Vvaz", "Valor_Limpo": 45000.0, "Abertura_Parsed": {"abertos": 6, "total": 15, "percentual": 40.0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "NIO", "AGÊNCIA": "BTN", "Valor/mês": 5000, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Não", "Report Semanal": "Sim", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "FOI UMA EXPERIÊNCIA FEITA DIRETAMETNE COM BTN, ONDE NÓS LANÇAMOS AS INSERÇÕES DOS BOLETINS DE UM CLIENE DELES, NIO E AVALIAMOS OS RESULTADOS. 16/01 RICARDO FEZ CALL COM ELES PARA APRESENTAR O REPORT E GOSTARAM BASTANTE. 20/01 RICARDO VENDO COM ARTHUR SOBRE AJUSTES NO REPORT", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 5000.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "PAGSEGURO / UOL", "AGÊNCIA": "NÃO TEM", "Valor/mês": 15700, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "O CONTRATO DELES É MAIS ANTIGO E POR ISSO TEM O MODELO SAS, MENSALMENTE FAZEMOS O ACOMPANHAMENTO DE 1 CAMPANHA DE RÁDIO, MAS OS REPORTS SÃO ELES MESMO QUE FAZEM. ÚLTIMO FOLLOW 20/01. ELES NÃO TIVERAM CAMPANHA EM DEZEMBRO E JANEIRO AINDA ESTÁ EM ABERTO. PENDENTE ANDRÉ RETORNAR PRO RICARDO E ALÊ SOBRE RENOVAÇÃO. 05/01/2026 - Ricardo autorizou manter aberto acesso até 31/01/2026, enquando consolida renovação do contrato.", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 15700.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "PUBLISET (CNPJ SEGUROS)", "AGÊNCIA": "PUBLISET", "Valor/mês": NaN, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "ACOMPANHAMENTO DE CAMPANHA FEITA PELA PUBLISET", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "PUBLISET (EDITORA SIMETRIA)", "AGÊNCIA": "PUBLISET", "Valor/mês": 3589.65, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "ACOMPANHAMENTO DE CAMPANHA FEITA PELA PUBLISET", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 3589.65, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "PUBLISET (FATAL MODEL)", "AGÊNCIA": "PUBLISET", "Valor/mês": 5068.34, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "PAULO SOLICITOU CHECKING DE VÍDEO. 19/01 PENDENTE ELE APROVAR O ACRÉSCIMO DE VALOR E PASSAR OS DADOS DA CAMPANHA", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 5068.34, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "PUBLISET (HUGHESNET)", "AGÊNCIA": "PUBLISET", "Valor/mês": 5535.26, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "ACOMPANHAMENTO DE CAMPANHA FEITA PELA PUBLISET", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 5535.26, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "PUBLISET (OCEANO)", "AGÊNCIA": "PUBLISET", "Valor/mês": NaN, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "RICARDO QUE TRATA COM ELES E PUBLISET", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "PUBLISET (UNIDAS)", "AGÊNCIA": "PUBLISET", "Valor/mês": 5347.3, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "RICARDO QUE TRATA COM ELES E PUBLISET", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 5347.3, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "PUBLISET (VERO INTERNET)", "AGÊNCIA": "PUBLISET", "Valor/mês": NaN, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "RICARDO QUE TRATA COM ELES E PUBLISET", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "RENAULT", "AGÊNCIA": "DPZ", "Valor/mês": 30000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Sim", "API": "Sim", "OBSERVAÇÕES": "O REPORT FINAL JÁ FOI ENCAMINHADO, ESTAMOS EM FASE DE RENOVAÇÃO, VAMOS FAZER UM COMPARATIVO COM O PERÍODO QUE TEVE X O QUE NÃO TEVE CAMPANHA E O MARKET INSIGHTS.", "ABERTURA DE REPORT": "0 de 5", "QUEM ABRIU": "-", "Valor_Limpo": 30000.0, "Abertura_Parsed": {"abertos": 0, "total": 5, "percentual": 0.0}}, {"CONTRATO ATÉ": "2026-03-01 00:00:00", "CLIENTE": "RECORD", "AGÊNCIA": "NÃO TEM", "Valor/mês": 35000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Não", "Market Insights": "Não", "API": "Sim", "OBSERVAÇÕES": "PARA 2026 FICAMOS COM ACESSO ABERTO ATÉ MARÇO, PARA QUE AVALIEM SE VÃO RENOVAR ANUAL DE NOVO, EM FUNÇÃO DA QUESTÃO DA DIFICULDADE DE ANALISAR QUANDO SÃO CLIENTES COM POUCAS BUSCAS (MESMO CASO DE GRUPO RIC), FOLLOWS PRINCIPALMENTE COM ISAQUE QUE É QUEM USA, MAS ELE NÃO ESTÁ RESPONDENDO ESSE ANO AINDA. MAS ELE FAZ OS REPORTS INTERNAMENTE SOZINHO TAMBÉM. 20/01 OUTRO FOLLOW POR WHATSAPP", "ABERTURA DE REPORT": "0 de 4", "QUEM ABRIU": "-", "Valor_Limpo": 35000.0, "Abertura_Parsed": {"abertos": 0, "total": 4, "percentual": 0.0}}, {"CONTRATO ATÉ": "2026-01-01 00:00:00", "CLIENTE": "RIACHUELO", "AGÊNCIA": "DROGA5", "Valor/mês": 15000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Não", "Market Insights": "Não", "API": "Sim", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "0 de 12", "QUEM ABRIU": "-", "Valor_Limpo": 15000.0, "Abertura_Parsed": {"abertos": 0, "total": 12, "percentual": 0.0}}, {"CONTRATO ATÉ": "2025-01-01 00:00:00", "CLIENTE": "RPC", "AGÊNCIA": "NÃO TEM", "Valor/mês": 5759, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Sim", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 5759.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}, {"CONTRATO ATÉ": "2025-02-01 00:00:00", "CLIENTE": "SERASA", "AGÊNCIA": "NÃO TEM", "Valor/mês": "Valores não encontrados", "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Não", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "0 de 4", "QUEM ABRIU": "-", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 0, "total": 4, "percentual": 0.0}}, {"CONTRATO ATÉ": "2026-06-01 00:00:00", "CLIENTE": "SKY BANDA LARGA", "AGÊNCIA": "DENTSU | BLUE.AG", "Valor/mês": 24399.99, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Sim", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "3 de 18", "QUEM ABRIU": "Pedro Santos, Camilla Arnaud, Flávio", "Valor_Limpo": 24399.99, "Abertura_Parsed": {"abertos": 3, "total": 18, "percentual": 16.666666666666664}}, {"CONTRATO ATÉ": "2025-10-01 00:00:00", "CLIENTE": "SMILES", "AGÊNCIA": "CADASTRA", "Valor/mês": 8000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "5 de 7", "QUEM ABRIU": "Guilherme Pessini, Nathan Gonçalves, Milena Toillier, Lizandra, Helen Pereira", "Valor_Limpo": 8000.0, "Abertura_Parsed": {"abertos": 5, "total": 7, "percentual": 71.42857142857143}}, {"CONTRATO ATÉ": "2025-06-01 00:00:00", "CLIENTE": "STELLANTIS", "AGÊNCIA": "MUCHMORE", "Valor/mês": 34200, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Sim", "API": "Sim", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "2 de 14", "QUEM ABRIU": "Leonardo Oliveira, Bruno Gonçalves", "Valor_Limpo": 34200.0, "Abertura_Parsed": {"abertos": 2, "total": 14, "percentual": 14.285714285714285}}, {"CONTRATO ATÉ": "2025-09-01 00:00:00", "CLIENTE": "STIHL", "AGÊNCIA": "AGÊNCIA ESCALA", "Valor/mês": 13000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Não", "API": "Sim", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "0 de 3", "QUEM ABRIU": "-", "Valor_Limpo": 13000.0, "Abertura_Parsed": {"abertos": 0, "total": 3, "percentual": 0.0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "SUPERSIM", "AGÊNCIA": "AGÊNCIA ESCALA", "Valor/mês": 65000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Não", "API": "Sim", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "15 de 21", "QUEM ABRIU": "Fábio Caetano, Alexsander Drews, Caio Japiassu, David Faria, Felipe Menezes, Gabriel Coutinho, Henrique Marcondes, Letícia Vinhas, Marcus Couto, Pedro Campos, Priscilla Nicolellis, Rafael Lopes, Cecília Bandeira, Igor Bleidorn, Nathalia Oliveira", "Valor_Limpo": 65000.0, "Abertura_Parsed": {"abertos": 15, "total": 21, "percentual": 71.42857142857143}}, {"CONTRATO ATÉ": "2026-02-01 00:00:00", "CLIENTE": "VERO", "AGÊNCIA": "SENSO PERFORMANCE", "Valor/mês": "Valores não encontrados", "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "6 de 6", "QUEM ABRIU": "Brendow Freire, Daniela C, Danilo M, Hamilton Guimarães, Natalia Di, Paulo Guimarães\n", "Valor_Limpo": 0.0, "Abertura_Parsed": {"abertos": 6, "total": 6, "percentual": 100.0}}, {"CONTRATO ATÉ": "2025-12-01 00:00:00", "CLIENTE": "VOLKSWAGEN", "AGÊNCIA": "ALMAP", "Valor/mês": 30000, "Tipo de Contrato": "Atribuição", "Sync": "Sim", "Report Mensal": "Sim", "Report Semanal": "Sim", "Market Insights": "Não", "API": "Sim", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "1 de 16", "QUEM ABRIU": "Thatiana Nogueira", "Valor_Limpo": 30000.0, "Abertura_Parsed": {"abertos": 1, "total": 16, "percentual": 6.25}}, {"CONTRATO ATÉ": "2026-02-01 00:00:00", "CLIENTE": "YPÊ", "AGÊNCIA": "ZMES", "Valor/mês": 13340, "Tipo de Contrato": "Atribuição", "Sync": "Não", "Report Mensal": "Não", "Report Semanal": "Não", "Market Insights": "Não", "API": "Não", "OBSERVAÇÕES": "", "ABERTURA DE REPORT": "0 de 0", "QUEM ABRIU": "-", "Valor_Limpo": 13340.0, "Abertura_Parsed": {"abertos": 0, "total": 0, "percentual": 0}}];
    
    let filteredData = [];
    let currentPage = 1;
    const itemsPerPage = 10;

    function init() {
        console.log('Total de clientes:', clientesData.length);
        
        // Processar dados
        clientesData.forEach(cliente => {
            cliente.valorNumerico = parseFloat(cliente.Valor_Limpo) || 0;
            
            const contratoDate = new Date(cliente['CONTRATO ATÉ']);
            const hoje = new Date();
            const diasRestantes = Math.ceil((contratoDate - hoje) / (1000 * 60 * 60 * 24));
            cliente.diasRestantes = diasRestantes;
            cliente.emRisco = (diasRestantes <= 60 && cliente.Abertura_Parsed.percentual < 30);
        });

        filteredData = [...clientesData];
        updateDashboard();
        populateFilters();
        
        const hoje = new Date();
        const dia = String(hoje.getDate()).padStart(2, '0');
        const mes = String(hoje.getMonth() + 1).padStart(2, '0');
        const ano = hoje.getFullYear();
        document.getElementById('currentDate').textContent = `Atualizado em ${dia}-${mes}-${ano}`;
    }

    function updateDashboard() {
        updateKPIs();
        updateTable();
        updateCharts();
    }

    function updateKPIs() {
        const receitaTotal = filteredData.reduce((sum, c) => sum + c.valorNumerico, 0);
        const clientesComReports = filteredData.filter(c => c.Abertura_Parsed.total > 0);
        const taxaEngajamento = clientesComReports.length > 0
            ? clientesComReports.reduce((sum, c) => sum + c.Abertura_Parsed.percentual, 0) / clientesComReports.length
            : 0;
        const clientesRisco = filteredData.filter(c => c.emRisco).length;

        document.getElementById('receitaTotal').textContent = 
            `R$ ${receitaTotal.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
        document.getElementById('clientesAtivos').textContent = filteredData.length;
        document.getElementById('taxaEngajamento').textContent = `${taxaEngajamento.toFixed(1)}%`;
        document.getElementById('clientesRisco').textContent = clientesRisco;
    }

    function updateTable() {
        const tbody = document.getElementById('tableBody');
        
        if (filteredData.length === 0) {
            tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;padding:50px;">Nenhum cliente encontrado</td></tr>';
            updatePaginationInfo();
            return;
        }

        // Calcular índices da página atual
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const paginatedData = filteredData.slice(startIndex, endIndex);

        tbody.innerHTML = paginatedData.map((cliente, pageIndex) => {
            const index = startIndex + pageIndex; // Índice real no filteredData
            const servicos = [];
            if (cliente.Sync === 'Sim') servicos.push('Sync');
            if (cliente['Report Mensal'] === 'Sim') servicos.push('Report Mensal');
            if (cliente['Report Semanal'] === 'Sim') servicos.push('Report Semanal');
            if (cliente['Market Insights'] === 'Sim') servicos.push('Insights');
            if (cliente.API === 'Sim') servicos.push('API');

            const engClass = cliente.Abertura_Parsed.percentual >= 60 ? 'high' : 
                           cliente.Abertura_Parsed.percentual >= 30 ? 'medium' : 'low';

            const contratoDate = new Date(cliente['CONTRATO ATÉ']);
            const contratoFormatado = contratoDate.toLocaleDateString('pt-BR', {month: '2-digit', year: 'numeric'});

            const valorExibicao = cliente.valorNumerico > 0 
                ? `R$ ${cliente.valorNumerico.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`
                : 'N/A';

            return `
                <tr onclick="showDetails(${index})">
                    <td><strong>${cliente.CLIENTE}</strong></td>
                    <td>${cliente['AGÊNCIA']}</td>
                    <td>${contratoFormatado}</td>
                    <td><strong>${valorExibicao}</strong></td>
                    <td>${cliente['Tipo de Contrato']}</td>
                    <td>
                        <div>${cliente.Abertura_Parsed.percentual.toFixed(0)}% (${cliente.Abertura_Parsed.abertos}/${cliente.Abertura_Parsed.total})</div>
                        <div class="engagement-bar">
                            <div class="engagement-fill ${engClass}" style="width: ${cliente.Abertura_Parsed.percentual}%"></div>
                        </div>
                    </td>
                    <td><small>${servicos.join(', ') || 'N/A'}</small></td>
                    <td>
                        ${cliente.emRisco ? '<span class="badge badge-risco">⚠ Risco</span>' : '<span class="badge badge-sim">✓ OK</span>'}
                    </td>
                </tr>
            `;
        }).join('');
        
        updatePaginationInfo();
    }
    
    function updatePaginationInfo() {
        const totalPages = Math.ceil(filteredData.length / itemsPerPage);
        const startIndex = (currentPage - 1) * itemsPerPage + 1;
        const endIndex = Math.min(currentPage * itemsPerPage, filteredData.length);
        
        document.getElementById('showingStart').textContent = filteredData.length > 0 ? startIndex : 0;
        document.getElementById('showingEnd').textContent = endIndex;
        document.getElementById('totalClientes').textContent = filteredData.length;
        
        // Atualizar botões
        document.getElementById('btnPrevious').disabled = currentPage === 1;
        document.getElementById('btnNext').disabled = currentPage >= totalPages;
        
        // Atualizar páginas
        const pagesContainer = document.getElementById('paginationPages');
        pagesContainer.innerHTML = '';
        
        // Mostrar no máximo 5 páginas
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, startPage + 4);
        
        if (endPage - startPage < 4) {
            startPage = Math.max(1, endPage - 4);
        }
        
        for (let i = startPage; i <= endPage; i++) {
            const pageBtn = document.createElement('div');
            pageBtn.className = 'pagination-page' + (i === currentPage ? ' active' : '');
            pageBtn.textContent = i;
            pageBtn.onclick = () => goToPage(i);
            pagesContainer.appendChild(pageBtn);
        }
    }
    
    function goToPage(page) {
        currentPage = page;
        updateTable();
    }
    
    function nextPage() {
        const totalPages = Math.ceil(filteredData.length / itemsPerPage);
        if (currentPage < totalPages) {
            currentPage++;
            updateTable();
        }
    }
    
    function previousPage() {
        if (currentPage > 1) {
            currentPage--;
            updateTable();
        }
    }

    function updateCharts() {
        const comReports = clientesData.filter(c => c.Abertura_Parsed.total > 0);
        
        // Top Engajados
        const topEngajados = [...comReports].sort((a, b) => b.Abertura_Parsed.percentual - a.Abertura_Parsed.percentual).slice(0, 10);
        document.getElementById('topEngajados').innerHTML = topEngajados.map((c, i) => {
            const rankClass = i === 0 ? 'top-1' : i === 1 ? 'top-2' : i === 2 ? 'top-3' : '';
            return `
                <div class="ranking-item ${rankClass}">
                    <div class="ranking-number">${i + 1}</div>
                    <div class="ranking-info">
                        <div>
                            <strong>${c.CLIENTE}</strong><br>
                            <small>${c.Abertura_Parsed.abertos}/${c.Abertura_Parsed.total} abriram o report</small>
                        </div>
                    </div>
                    <div class="ranking-score">${c.Abertura_Parsed.percentual.toFixed(0)}%</div>
                </div>
            `;
        }).join('');

        // Top Menos Engajados
        const topMenos = [...comReports].sort((a, b) => a.Abertura_Parsed.percentual - b.Abertura_Parsed.percentual).slice(0, 10);
        document.getElementById('topMenosEngajados').innerHTML = topMenos.map((c, i) => `
            <div class="ranking-item">
                <div class="ranking-number" style="background: var(--laranja)">${i + 1}</div>
                <div class="ranking-info">
                    <div>
                        <strong>${c.CLIENTE}</strong><br>
                        <small>${c.Abertura_Parsed.abertos}/${c.Abertura_Parsed.total} abriram o report</small>
                    </div>
                </div>
                <div class="ranking-score" style="color: var(--laranja)">${c.Abertura_Parsed.percentual.toFixed(0)}%</div>
            </div>
        `).join('');

        // Receita por Tipo
        const receitaPorTipo = {};
        clientesData.forEach(c => {
            const tipo = c['Tipo de Contrato'] || 'Não definido';
            receitaPorTipo[tipo] = (receitaPorTipo[tipo] || 0) + c.valorNumerico;
        });

        const maxReceita = Math.max(...Object.values(receitaPorTipo));
        document.getElementById('receitaTipo').innerHTML = Object.entries(receitaPorTipo)
            .sort((a, b) => b[1] - a[1])
            .map(([tipo, valor]) => `
                <div class="chart-bar">
                    <div class="chart-bar-label">${tipo}</div>
                    <div class="chart-bar-container">
                        <div class="chart-bar-fill" style="width: ${(valor/maxReceita)*100}%">
                            R$ ${valor.toLocaleString('pt-BR', {minimumFractionDigits: 0})}
                        </div>
                    </div>
                </div>
            `).join('');

        // Distribuição de Serviços
        const servicos = {
            'Sync': clientesData.filter(c => c.Sync === 'Sim').length,
            'Report Mensal': clientesData.filter(c => c['Report Mensal'] === 'Sim').length,
            'Report Semanal': clientesData.filter(c => c['Report Semanal'] === 'Sim').length,
            'Market Insights': clientesData.filter(c => c['Market Insights'] === 'Sim').length,
            'API': clientesData.filter(c => c.API === 'Sim').length
        };

        const maxServico = Math.max(...Object.values(servicos));
        document.getElementById('distribuicaoServicos').innerHTML = Object.entries(servicos)
            .sort((a, b) => b[1] - a[1])
            .map(([servico, count]) => `
                <div class="chart-bar">
                    <div class="chart-bar-label">${servico}</div>
                    <div class="chart-bar-container">
                        <div class="chart-bar-fill" style="width: ${(count/maxServico)*100}%; background: linear-gradient(90deg, var(--lima), var(--laranja))">
                            ${count} clientes
                        </div>
                    </div>
                </div>
            `).join('');
        
        // Top Contratos Vencendo
        const topVencendo = [...clientesData]
            .sort((a, b) => a.diasRestantes - b.diasRestantes)
            .slice(0, 10);
        
        document.getElementById('topVencendo').innerHTML = topVencendo.map((c, i) => {
            const rankClass = i === 0 ? 'top-1' : i === 1 ? 'top-2' : i === 2 ? 'top-3' : '';
            const diasClass = c.diasRestantes <= 30 ? 'urgente' : c.diasRestantes <= 60 ? 'atencao' : '';
            const contratoDate = new Date(c['CONTRATO ATÉ']);
            const contratoFormatado = contratoDate.toLocaleDateString('pt-BR', {month: '2-digit', year: 'numeric'});
            
            return `
                <div class="ranking-item ${rankClass}">
                    <div class="ranking-number">${i + 1}</div>
                    <div class="ranking-info">
                        <div>
                            <strong>${c.CLIENTE}</strong><br>
                            <small>${contratoFormatado}</small>
                            <div class="dias-restantes ${diasClass}">
                                ${c.diasRestantes > 0 ? c.diasRestantes + ' dias' : 'VENCIDO'}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }).join('');
        
        updatePaginationInfo();
    }
    
    function updatePaginationInfo() {
        const totalPages = Math.ceil(filteredData.length / itemsPerPage);
        const startIndex = (currentPage - 1) * itemsPerPage + 1;
        const endIndex = Math.min(currentPage * itemsPerPage, filteredData.length);
        
        document.getElementById('showingStart').textContent = filteredData.length > 0 ? startIndex : 0;
        document.getElementById('showingEnd').textContent = endIndex;
        document.getElementById('totalClientes').textContent = filteredData.length;
        
        // Atualizar botões
        document.getElementById('btnPrevious').disabled = currentPage === 1;
        document.getElementById('btnNext').disabled = currentPage >= totalPages;
        
        // Atualizar páginas
        const pagesContainer = document.getElementById('paginationPages');
        pagesContainer.innerHTML = '';
        
        // Mostrar no máximo 5 páginas
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(totalPages, startPage + 4);
        
        if (endPage - startPage < 4) {
            startPage = Math.max(1, endPage - 4);
        }
        
        for (let i = startPage; i <= endPage; i++) {
            const pageBtn = document.createElement('div');
            pageBtn.className = 'pagination-page' + (i === currentPage ? ' active' : '');
            pageBtn.textContent = i;
            pageBtn.onclick = () => goToPage(i);
            pagesContainer.appendChild(pageBtn);
        }
    }
    
    function goToPage(page) {
        currentPage = page;
        updateTable();
    }
    
    function nextPage() {
        const totalPages = Math.ceil(filteredData.length / itemsPerPage);
        if (currentPage < totalPages) {
            currentPage++;
            updateTable();
        }
    }
    
    function previousPage() {
        if (currentPage > 1) {
            currentPage--;
            updateTable();
        }
    }

    function populateFilters() {
        const agencias = [...new Set(clientesData.map(c => c['AGÊNCIA']))].sort();
        document.getElementById('agenciaFilter').innerHTML = '<option value="">Todas as Agências</option>' +
            agencias.map(a => `<option value="${a}">${a}</option>`).join('');

        const tipos = [...new Set(clientesData.map(c => c['Tipo de Contrato']))].sort();
        document.getElementById('contratoFilter').innerHTML = '<option value="">Todos os Tipos</option>' +
            tipos.map(t => `<option value="${t}">${t}</option>`).join('');
    }

    function applyFilters() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const agenciaFilter = document.getElementById('agenciaFilter').value;
        const contratoFilter = document.getElementById('contratoFilter').value;
        const riscoFilter = document.getElementById('riscoFilter').value;

        filteredData = clientesData.filter(cliente => {
            const matchSearch = cliente.CLIENTE.toLowerCase().includes(searchTerm);
            const matchAgencia = !agenciaFilter || cliente['AGÊNCIA'] === agenciaFilter;
            const matchContrato = !contratoFilter || cliente['Tipo de Contrato'] === contratoFilter;
            const matchRisco = !riscoFilter || 
                (riscoFilter === 'risco' && cliente.emRisco) ||
                (riscoFilter === 'seguro' && !cliente.emRisco);

            return matchSearch && matchAgencia && matchContrato && matchRisco;
        });

        currentPage = 1; // Resetar para primeira página
        updateDashboard();
    }

    document.getElementById('searchInput').addEventListener('input', applyFilters);
    document.getElementById('agenciaFilter').addEventListener('change', applyFilters);
    document.getElementById('contratoFilter').addEventListener('change', applyFilters);
    document.getElementById('riscoFilter').addEventListener('change', applyFilters);

    function showDetails(index) {
        const cliente = filteredData[index];
        const modal = document.getElementById('clienteModal');

        document.getElementById('modalTitle').textContent = cliente.CLIENTE;
        
        const valorExibicao = cliente.valorNumerico > 0 
            ? `R$ ${cliente.valorNumerico.toLocaleString('pt-BR', {minimumFractionDigits: 2})}/mês`
            : 'Valor não informado';
        document.getElementById('modalValor').textContent = valorExibicao;

        const contratoDate = new Date(cliente['CONTRATO ATÉ']);
        const contratoFormatado = contratoDate.toLocaleDateString('pt-BR');

        const quemAbriu = cliente['QUEM ABRIU'] && cliente['QUEM ABRIU'] !== '-' 
            ? String(cliente['QUEM ABRIU']).replace(/\n/g, '').trim()
            : 'Ninguém abriu ainda';

        const servicosAtivos = [];
        if (cliente.Sync === 'Sim') servicosAtivos.push('✓ Sync');
        if (cliente['Report Mensal'] === 'Sim') servicosAtivos.push('✓ Report Mensal');
        if (cliente['Report Semanal'] === 'Sim') servicosAtivos.push('✓ Report Semanal');
        if (cliente['Market Insights'] === 'Sim') servicosAtivos.push('✓ Market Insights');
        if (cliente.API === 'Sim') servicosAtivos.push('✓ API');

        document.getElementById('modalBody').innerHTML = `
            <div class="detail-section">
                <h3>Informações Gerais</h3>
                <div class="detail-grid">
                    <div class="detail-item">
                        <label>Cliente</label>
                        <value>${cliente.CLIENTE}</value>
                    </div>
                    <div class="detail-item">
                        <label>Agência</label>
                        <value>${cliente['AGÊNCIA']}</value>
                    </div>
                    <div class="detail-item">
                        <label>Contrato Até</label>
                        <value>${contratoFormatado} (${cliente.diasRestantes} dias)</value>
                    </div>
                    <div class="detail-item">
                        <label>Valor Mensal</label>
                        <value>${valorExibicao}</value>
                    </div>
                    <div class="detail-item">
                        <label>Tipo de Contrato</label>
                        <value>${cliente['Tipo de Contrato']}</value>
                    </div>
                    <div class="detail-item">
                        <label>Status de Risco</label>
                        <value>${cliente.emRisco ? '⚠️ Em Risco de Churn' : '✅ Seguro'}</value>
                    </div>
                </div>
            </div>

            <div class="detail-section">
                <h3>Engajamento com Reports</h3>
                <div class="detail-grid">
                    <div class="detail-item">
                        <label>Taxa de Abertura</label>
                        <value>${cliente.Abertura_Parsed.percentual.toFixed(1)}%</value>
                    </div>
                    <div class="detail-item">
                        <label>Reports Abertos</label>
                        <value>${cliente.Abertura_Parsed.abertos} de ${cliente.Abertura_Parsed.total}</value>
                    </div>
                </div>
                <div class="detail-item" style="margin-top: 15px;">
                    <label>Quem Abriu os Reports</label>
                    <value>${quemAbriu}</value>
                </div>
            </div>

            <div class="detail-section">
                <h3>Serviços Contratados</h3>
                <div class="detail-item">
                    <value>${servicosAtivos.join('<br>') || 'Nenhum serviço ativo'}</value>
                </div>
            </div>

            <div class="detail-section">
                <h3>Observações do Atendimento</h3>
                <div class="observacoes-box">
                    ${cliente['OBSERVAÇÕES'] || 'Sem observações registradas'}
                </div>
            </div>
        `;

        modal.style.display = 'block';
    }

    document.querySelector('.close').onclick = function() {
        document.getElementById('clienteModal').style.display = 'none';
    }

    window.onclick = function(event) {
        const modal = document.getElementById('clienteModal');
        if (event.target == modal) modal.style.display = 'none';
    }

    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            document.getElementById('clienteModal').style.display = 'none';
        }
    });

    let sortDirection = {};
    function sortTable(columnIndex) {
        const direction = sortDirection[columnIndex] === 'asc' ? 'desc' : 'asc';
        sortDirection[columnIndex] = direction;

        filteredData.sort((a, b) => {
            let aVal, bVal;
            switch(columnIndex) {
                case 0: aVal = a.CLIENTE; bVal = b.CLIENTE; break;
                case 1: aVal = a['AGÊNCIA']; bVal = b['AGÊNCIA']; break;
                case 2: aVal = new Date(a['CONTRATO ATÉ']); bVal = new Date(b['CONTRATO ATÉ']); break;
                case 3: aVal = a.valorNumerico; bVal = b.valorNumerico; break;
                case 4: aVal = a['Tipo de Contrato']; bVal = b['Tipo de Contrato']; break;
                default: return 0;
            }

            if (aVal < bVal) return direction === 'asc' ? -1 : 1;
            if (aVal > bVal) return direction === 'asc' ? 1 : -1;
            return 0;
        });

        currentPage = 1; // Resetar para primeira página
        updateTable();
    }

    init();
    </script>
</body>
</html>